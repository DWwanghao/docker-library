# This file is generated by the template.

REGISTRY	?=lcr.loongnix.cn
ORGANIZATION	?=dapr
REPOSITORY	?=dapr
TAG		?=1.15.3
LATEST		?=true

IMAGE=$(REGISTRY)/$(ORGANIZATION)/$(REPOSITORY):$(TAG)
LATEST_IMAGE=$(REGISTRY)/$(ORGANIZATION)/$(REPOSITORY):latest
PATCH=0001-add-loong64-support.patch
default: image

src: clean
	wget http://cloud.loongnix.cn/releases/loongarch64/dapr/dapr/1.15.3/dapr-1.15.3-linux-loong64.tar.gz && mkdir dist && cd dist && tar xf ../dapr-1.15.3-linux-loong64.tar.gz
#	git clone --depth 1 -b v1.15.3 https://github.com/dapr/dapr

image: src
	cd dist && docker build --build-arg PKG_FILES=* -t lcr.loongnix.cn/daprio/dapr:1.15.3 -f ../docker/Dockerfile .
#	cd dist && docker build --build-arg PKG_FILES=* -t lcr.loongnix.cn/daprio/dapr:1.15.3-mariner -f ../docker/Dockerfile-mariner
push:
	docker push lcr.loongnix.cn/daprio/dapr:1.15.3
clean:
	rm -rf dapr* dist
